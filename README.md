# PR4
PR4
Итератор — это поведенческий паттерн проектирования, который даёт возможность
последовательно обходить элементы составных объектов, не раскрывая их внутреннего
представления.

Посетитель (Visitor)
Посетитель — это поведенческий паттерн проектирования, который позволяет добавлять в
программу новые операции, не изменяя классы объектов, над которыми эти операции могут
выполняться.
Паттерн Посетитель предлагает разместить новое поведение в отдельном классе, вместо того
чтобы множить его сразу в нескольких классах. Объекты, с которыми должно было быть связано
поведение, не будут выполнять его самостоятельно. Вместо этого вы будете передавать эти
объекты в методы посетителя.
Код поведения, скорее всего, должен отличаться для объектов разных классов, поэтому и методов
у посетителя должно быть несколько. Названия и принцип действия этих методов будет схож, но
основное отличие будет в типе принимаемого в параметрах объекта, например:
class ExportVisitor implements Visitor is
 method doForCity(City c) { ... }
 method doForIndustry(Industry f) { ... }
 method doForSightSeeing(SightSeeing ss) { ... }
 // ...
Здесь возникает вопрос: как подавать узлы в объект-посетитель? Так как все методы имеют
отличающуюся сигнатуру, использовать полиморфизм при переборе узлов не получится. Придётся
проверять тип узлов для того, чтобы выбрать соответствующий метод посетителя.
foreach (Node node in graph)
 if (node instanceof City)
 exportVisitor.doForCity((City) node)
 if (node instanceof Industry)
 exportVisitor.doForIndustry((Industry) node)
 // ...
Тут не поможет даже механизм перегрузки методов (доступный в Java и C#). Если назвать все
методы одинаково, то неопределённость реального типа узла всё равно не даст вызвать
правильный метод. Механизм перегрузки всё время будет вызывать метод посетителя,
соответствующий типу Node, а не реального класса поданного узла.
Но паттерн Посетитель решает и эту проблему, используя механизм двойной диспетчеризации.
Вместо того, чтобы самим искать нужный метод, мы можем поручить это объектам, которые
передаём в параметрах посетителю. А они уже вызовут правильный метод посетителя.
